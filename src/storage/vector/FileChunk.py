from qdrant_client.http.models import MatchValue
from qdrant_client.models import Filter, FieldCondition, NamedVector

from src.storage.vector.BaseVectorRepository import BaseVectorRepository


# 文件分片向量的crud 和相似查询
class FileChunk(BaseVectorRepository):

    # 获得所有的collection 数组
    def get_collections(self):
        return self.get_client().get_collections()

    # 统计collection中的point总数
    def count_collection(self):
        result = self.get_client().count(self.collection_name)
        return result

    # 根据id获得point
    def get_point(self, id: int):
        file_filter = Filter(
            must=[FieldCondition(key="id", match=MatchValue(value=id))]
        )
        result = self.get_client().scroll(self.collection_name, scroll_filter=file_filter, with_payload=True, limit=1)
        return result

    def count_file_points(self, file_id: int):
        file_filter = Filter(
            must=[FieldCondition(key="metadata.file_id", match=MatchValue(value=file_id))]
        )
        result = self.get_client().count(self.collection_name, count_filter=file_filter)
        return result

    # 获得文件的向量数组
    def get_file_points(self, file_id: int):
        file_filter = Filter(
            must=[FieldCondition(key="metadata.file_id", match=MatchValue(value=file_id))]
        )

        result = self.get_client().scroll(self.collection_name, scroll_filter=file_filter, with_payload=True,
                                          limit=100, )
        return result

    # 删除向量
    def delete_points(self, file_id: int):
        file_filter = Filter(
            must=[FieldCondition(key="metadata.file_id", match=MatchValue(value=file_id))]
        )
        self.get_client().delete(self.collection_name, points_selector=file_filter)

    # 保存向量
    def save_points(self, points):
        self.get_client().upsert(self.collection_name, points=points, wait=True)
        return True

    # 搜索相似向量
    def search_points(self, file_id: int, vector: []):
        file_filter = Filter(
            must=[FieldCondition(key="metadata.file_id", match=MatchValue(value=file_id))]
        )
        query_vector = {"name": "text", "vector": vector}
        result = self.get_client().search(self.collection_name, query_vector=query_vector, query_filter=file_filter)
        return result


a = [0.008514415472745895, 0.01031968742609024,
0.019009241834282875, -0.02093576267361641, -0.03909625858068466, 0.018739797174930573, -0.030150732025504112,
0.01054871454834938, -0.040578197687864304, -0.022053953260183334, 0.01725785806775093, 0.02683657594025135,
-0.016436055302619934, -0.004594012163579464, 0.0052305725403130054, 0.004489602986723185, 0.004833143204450607,
0.01496758870780468, 0.03944653272628784, 0.019130490720272064, -0.017702439799904823, 0.019305629655718803,
-0.023064367473125458, 0.0028173690661787987, -0.004580540116876364, 0.010723852552473545, 0.017877578735351562,
-0.01875326968729496, -0.01310169231146574, -0.014805922284722328, 0.047637615352869034, -0.003954083658754826,
-0.025421997532248497, -0.01190266851335764, -0.015600780956447124, -0.003943979740142822, 0.0061972010880708694,
-0.0145634226500988, 0.02963878959417343, 0.003492661751806736, 0.028129905462265015, 0.015614252537488937,
0.005193524062633514, 0.02121867798268795, -0.0034135128371417522, 0.017796745523810387, -0.006160152610391378,
0.009942466393113136, -0.010245590470731258, 0.010804685764014721, -0.011020240373909473, 0.004765782505273819,
0.0014667832292616367, -0.020545069128274918, 0.0009220020729117095, 0.02236381359398365, -0.0065003251656889915,
-0.0004580540116876364, 0.004004604648798704, -0.03548571467399597, 0.013660787604749203, 0.008487471379339695,
-0.03594376891851425, 0.025381581857800484, -0.012481971643865108, 0.01121558714658022, 0.010420728474855423,
0.02856101468205452, 0.015317864716053009, 0.006756296847015619, 0.006840497720986605, 0.016045361757278442,
0.00761177996173501, -0.00819781981408596, 0.0421140231192112, -0.037991538643836975, -0.02780657261610031,
-0.01368099544197321, -0.004199950955808163, 0.012906345538794994, 0.010959615930914879, -0.022175202146172523,
-0.006877546198666096, 0.030932117253541946, 0.008231500163674355, 0.03782987222075462, -0.02764490619301796,
0.019467296078801155, -0.0074501135386526585, -0.009868369437754154, 0.006459908559918404, 0.010387048125267029,
0.003573494963347912, 0.008601984940469265, 0.02396700158715248, 0.03297988697886467, 0.010494825430214405,
0.024222973734140396, -0.02449241653084755, -0.014496061950922012, 0.023320337757468224, -0.005614529829472303,
-0.025933939963579178, -0.02098965086042881, -0.011505238711833954, -0.018335632979869843, 0.012798568233847618,
0.007301919627934694, 0.031444061547517776, 0.0043009924702346325, -0.005338349845260382, 0.014374812133610249,
0.007214350625872612, -0.024977415800094604, -0.020693263038992882, 0.0010735640535131097, -0.011390725150704384,
-0.004169638734310865, -0.03518932685256004, -0.019413406029343605, 0.015385225415229797, 0.01954812929034233,
0.009181288070976734, -0.0257992185652256, 0.007328864187002182, 0.0064430683851242065, -0.0008066465961746871,
0.011410933919250965, 0.020693263038992882, -0.0145095344632864, 0.001965253846719861, -0.0032232182566076517,
0.007032476365566254, 0.016193555667996407, -0.025880051776766777, -0.01407842431217432, -0.028372405096888542,
0.024222973734140396, -0.01996576599776745, -0.02041034772992134, 0.013182524591684341, 0.011774682439863682,
-0.04747595265507698, -0.013121900148689747, 0.0004959445213899016, -0.005395606625825167, -0.004543491639196873,
0.02821073867380619, 0.001454153098165989, 0.003002611454576254, 0.014684672467410564, -0.023252977058291435,
0.02230992540717125, 0.0169075820595026, -0.0032956311479210854, -0.004651268944144249, 0.009848161600530148,
-0.0007721241563558578, -0.0015459322603419423, 0.0001685074676061049, 0.01017822977155447, 0.027968239039182663,
-0.004233631771057844, 0.021070484071969986, 0.004425609949976206, 0.025273803621530533, -0.007914903573691845,
-0.012657109647989273, 0.028587959706783295, -0.008763651363551617, -0.008527887985110283, 0.01817396655678749,
0.0021100796293467283, -0.010286007076501846, -0.0030211356934159994, 0.013889813795685768, 0.024047834798693657,
-0.004533387254923582, -0.023428115993738174, -0.008420110680162907, -0.004870191682130098, -0.010979823768138885,
0.03421932831406593, 0.002542873378843069, -0.010824893601238728, -0.01914396323263645, 0.01950771175324917,
0.005176683887839317, 0.014954116195440292, -0.03206378221511841, 0.0010895623126998544, 0.0072412951849401,
-0.022215619683265686, -0.021946175023913383, -0.6001046299934387, -0.027038658037781715, 0.005971542559564114,
-0.008480735123157501, 0.01181509904563427, 0.03389599546790123, 0.02276797778904438, -0.0022144890390336514,
0.001709282398223877, -0.0710253193974495, -0.014118840917944908, 0.010831629857420921, -0.0023862593807280064,
-0.011053920723497868, -0.028345460072159767, -0.032306279987096786, 0.009612398222088814, -0.0128726651892066,
0.020087014883756638, 0.006951643154025078, -0.007187406066805124, 0.03777598217129707, -0.016126194968819618,
0.006820289418101311, -0.014644255861639977, 0.015398697927594185, 0.011855515651404858, 0.015681613236665726,
-0.034327104687690735, 0.028857402503490448, -0.01933257281780243, 0.008029417134821415, 0.0021993329282850027,
0.002145444042980671, 0.05264926701784134, -0.016072306782007217, -0.003496029879897833, 0.024761861190199852,
0.0034168807324022055, 0.04750289395451546, -0.006992059759795666, -0.00891184527426958, 0.00926212128251791,
-0.016153139993548393, 0.016557306051254272, 0.0012301781680434942, 0.02602824568748474, 0.009841425344347954,
0.0011577651603147388, 0.00012282836541999131, 0.003182801650837064, 0.027995184063911438, 0.006742824334651232,
0.02081451378762722, 0.00026186543982475996, -0.01519661583006382, 0.047691505402326584, -0.02356283739209175,
0.0013665839796885848, -0.013889813795685768, 0.01425356324762106, 0.017284803092479706, -0.014927172102034092,
-0.024627139791846275, -0.007477058097720146, 0.030689619481563568, -0.012569541111588478, -0.0031642774119973183,
0.0026826472021639347, -0.012104750610888004, -0.00467484537512064, 0.013007386587560177, 0.0034067765809595585,
-0.0025277172680944204, 0.003752001328393817, 0.02644588239490986, 0.03562043607234955, -0.003479189705103636,
0.01195655670017004, 0.00019503080693539232, -0.008137194439768791, -0.010885518975555897, -0.012589748948812485,
-0.0018423201981931925, -0.002462040400132537, 0.004809567239135504, -0.01382245309650898, -0.032306279987096786,
0.00691122654825449, 0.013216204941272736, 0.04170985892415047, 0.025933939963579178, -0.02333381026983261,
-0.042248744517564774, -0.019682850688695908, 0.04849983751773834, -0.03761431574821472, -0.011053920723497868,
-0.008938789367675781, -0.000903477834071964, -0.013788772746920586, -0.028803514316678047, 0.010656491853296757,
0.01547953113913536, 0.024694500491023064, 0.001276488765142858, -0.012522388249635696, -0.018025772646069527,
0.008049625903367996, -0.02241770178079605, -0.006611470598727465, 0.013162316754460335, 0.023657143115997314,
0.009080247022211552, -0.016557306051254272, -0.02213478647172451, -0.012973706237971783, 0.01089899055659771,
0.015910640358924866, -0.013775301165878773, 0.007908167317509651, -0.004479498602449894, 0.017742857336997986,
0.0033697281032800674, 0.008554832078516483, -0.012973706237971783, 0.0031423852778971195, -0.00620730547234416,
0.0026186543982475996, -0.041440416127443314, -0.0010415676515549421, -0.02352241985499859, -0.011040449142456055,
-0.017177024856209755, 0.007052684668451548, -0.0007018162286840379, -0.001867580460384488, -0.015506475232541561,
-0.009982882998883724, 0.009316010400652885, -0.012845720164477825, 0.020289098843932152, 0.00456033181399107,
-0.0168536938726902, -0.02088187448680401, 0.007322127930819988, -0.006813553161919117, 0.0025681336410343647,
-0.0019703058060258627, -0.03521626815199852, 0.015789391472935677, -0.020140904933214188, 0.005601057317107916,
0.014186202548444271, 0.02264672890305519, 0.006763032637536526, -0.005904181394726038, -0.015008005313575268,
-0.00831233337521553, 0.0030177675653249025, -0.01869938150048256, 0.012205792590975761, -0.004082069732248783,
-0.007200878579169512, -0.005183420144021511, -0.010077187791466713, 0.021178262308239937, 0.0311476718634367,
-0.042814578860998154, -0.040120143443346024, -0.03187517076730728, -0.009336218237876892, 0.01933257281780243,
0.005109323188662529, -0.017190497368574142, -0.012091279029846191, -0.01479244977235794, -0.017338691279292107,
0.013862869702279568, -0.019184378907084465, 0.011828571557998657, 0.012448291294276714, -0.007867751643061638,
0.00036227525561116636, 0.01972326636314392, -7.878065662225708e-05, 0.013398080132901669, 0.011855515651404858,
-0.028884347528219223, 0.04782622680068016, -0.011060656979680061, 0.03448877111077309, -0.012630165554583073,
0.029557956382632256, 0.001165343332104385, 0.011922876350581646, 0.013728148303925991, -0.003219850128516555,
0.0015442483127117157, 0.0038564105052500963, 0.030258508399128914, -0.0025344532914459705, -0.015061893500387669,
-0.008393165655434132, 0.024802276864647865, -0.032144613564014435, -0.002297006081789732, -0.0156546700745821,
0.025906996801495552, 0.011141490191221237, 0.004105645697563887, -0.00620730547234416, 0.014428701251745224,
-0.02150159329175949, 0.009201496839523315, 0.014496061950922012, -0.007308655884116888, 0.0011703954078257084,
-0.01158607192337513, -0.0012882768642157316, 0.0037823135498911142, 0.01973673887550831, 0.013047803193330765,
-0.014832866378128529, 0.013027595356106758, 0.024007419124245644, 0.018537715077400208, 0.024115195497870445,
0.007402961142361164, -0.025314219295978546, -0.011963292956352234, -0.005678522400557995, 0.01405148021876812,
0.01864549331367016, 0.02373797632753849, 0.020464235916733742, 0.00679671298712492, -0.017177024856209755,
0.01754077337682247, 0.010043507441878319, -0.00269443541765213, 0.021205205470323563, 0.025260331109166145,
-0.01806618832051754, 0.01112801767885685, 0.01824132725596428, 0.028345460072159767, 0.027442824095487595,
-0.0144825903698802, 0.005904181394726038, -0.02477533370256424, -0.012347250245511532, -0.011094337329268456,
-0.010440937243402004, 0.005233940668404102, 0.00490387249737978, 0.008238236419856548, 0.012226000428199768,
0.001918101217597723, 0.010555450804531574, 0.02288922853767872, 0.0290190689265728, -0.012919817119836807,
0.009309274144470692, -0.00024734073667787015, -0.004823039285838604, -0.000500575581099838, -0.0009952570544555783,
-0.0025277172680944204, -0.0024603563360869884, 0.015964528545737267, -0.00877712294459343, 0.00678324094042182,
-0.016880637034773827, 0.030689619481563568, 0.010158021003007889, -0.007470321841537952, 0.013350927270948887,
0.004385193344205618, 0.016126194968819618, -0.02718685194849968, -0.01743299700319767, -0.009639342315495014,
0.043434299528598785, -0.008615457452833652, -0.031902115792036057, -0.032198503613471985, 0.01356648188084364,
0.02488311007618904, 0.008561568334698677, -0.0054393913596868515, 0.016085779294371605, -0.003560022683814168,
0.0040147085674107075, -0.0020679791923612356, 0.011222323402762413, 0.029800454154610634, -0.0032956311479210854,
-0.021151317283511162, -0.007322127930819988, 0.012428083457052708, -0.01241461094468832, -0.00480283098295331,
-0.027779627591371536, 0.02866879291832447, -0.0004761572345159948, 0.011895932257175446, -0.00739622488617897,
0.030824340879917145, -0.01875326968729496, -0.008413374423980713, -0.025933939963579178, -0.000251761288382113,
-0.044539015740156174, 0.0003700638480950147, 0.022498534992337227, -0.006759664509445429, 0.009679758921265602,
0.031336281448602676, -0.004290888085961342, -0.004678213503211737, 0.005547168664634228, 0.003275423077866435,
0.027860460802912712, 0.006143312435597181, 0.010831629857420921, 0.004590644035488367, 0.0002858627412933856,
0.000879901519510895, -0.002180808689445257, -0.03079739585518837, -0.014293979853391647, 0.028022127225995064,
-0.010771005414426327, 0.00046394809032790363, 0.0007401276961900294, -0.003688008291646838, -0.004812935367226601,
0.016436055302619934, 0.01278509572148323, 0.012818776071071625, -0.03195600211620331, 0.017850633710622787,
-0.029504066333174706, -0.009571981616318226, -0.018941881135106087, 0.03632098808884621, 0.0018052717205137014,
0.014913699589669704, -0.008703025989234447, 0.014145785942673683, 0.03192905709147453, 0.015129254199564457,
-0.0042639439925551414, -0.00903309416025877, -0.0050588021986186504, 0.008703025989234447, -0.0033730962313711643,
-0.002024194458499551, 0.005638105794787407, -0.009531565010547638, 0.019305629655718803, 0.01931910216808319,
0.02690393663942814, 0.02845323644578457, 0.014159257523715496, 0.0002978614065796137, -0.04009319841861725,
0.026850048452615738, -0.007214350625872612, 0.026351578533649445, 0.00562126561999321, -0.017163552343845367,
-0.015008005313575268, 0.010656491853296757, -0.009221704676747322, -0.016476472839713097, 0.019170908257365227,
-0.004742206074297428, 0.0002784951648209244, 0.001766539178788662, -0.01232704147696495, 0.018335632979869843,
-0.01813354901969433, -0.00759830791503191, -0.003560022683814168, 0.01840299367904663, -0.024007419124245644,
-0.010104132816195488, -0.005291197448968887, -0.0025108768604695797, -0.030770450830459595, -0.02620338462293148,
-0.008494207635521889, 0.020437292754650116, -0.00586376478895545, -0.044700682163238525, -0.004189847037196159,
0.007861015386879444, 0.00749726640060544, 0.02672879956662655, 0.005398974753916264, -0.020922290161252022,
0.02982739917933941, 0.03273738920688629, -0.023993946611881256, 0.014213146641850471, -0.01519661583006382,
-0.00863566529005766, 0.002180808689445257, -0.02093576267361641, -0.014172730036079884, 0.017796745523810387,
-0.0007868593093007803, 0.01473856158554554, -0.002059559104964137, 0.043272633105516434, -0.011525447480380535,
-0.0031188088469207287, -0.011485030874609947, -0.015681613236665726, 0.006870809942483902, -0.011660168878734112,
-0.018766742199659348, 0.023347282782197, -0.04273374378681183, -0.0027820044197142124, -0.028372405096888542,
0.01402453612536192, -0.0029571428894996643, -0.007578099612146616, -0.019184378907084465, -0.004075333476066589,
0.008723234757781029, -0.009390107356011868, -0.024613667279481888, -0.015008005313575268, -0.02098965086042881,
0.011868988163769245, 0.03497377038002014, -0.016718970611691475, -0.0032131141051650047, -0.023037422448396683,
0.0015257240738719702, 0.015115782618522644, -0.05555925518274307, 0.018079660832881927, 0.03200989216566086,
-0.008116986602544785, 0.018443409353494644, 0.0017134924419224262, -0.01430745143443346, -0.032306279987096786,
0.018510770052671432, 0.014725089073181152, 0.030231565237045288, 0.012838984839618206, -0.003950715996325016,
0.004277416039258242, -0.024155613034963608, -0.010400520637631416, 0.0034892938565462828, -0.008440318517386913,
0.0017951675690710545, -0.01829521544277668, 0.007409697398543358, 0.0157624464482069, -0.006917962804436684,
0.03335710987448692, -0.02918073534965515, -0.0067125121131539345, 0.011761209927499294, -0.0001878737093647942,
0.03893459215760231, -0.014145785942673683, 0.01667855493724346, -0.020342987030744553, -0.028129905462265015,
0.004718630108982325, -0.026365049183368683, -0.00596480630338192, -0.03249489143490791, 0.03354572132229805,
0.014469117857515812, 0.031794335693120956, 0.0013859501341357827, 0.0245463065803051, 0.017352163791656494,
0.007322127930819988, 0.0007439167820848525, -0.01868590898811817, 0.013526065275073051, -0.0017084403662011027,
0.0015602464554831386, 0.0043212007731199265, 0.007079628761857748, 0.006045639514923096, 0.003991132136434317,
-0.010831629857420921, 0.014819394797086716, 0.010562186129391193, 0.0016082411166280508, -0.01921132393181324,
-0.07797695696353912, -0.008696289733052254, -0.0001658761757425964, 0.011835306882858276, 0.008723234757781029,
-0.033168498426675797, 0.0007060262723825872, -0.02609560638666153, -0.012630165554583073, 0.0014263667399063706,
-0.0029773509595543146, 0.029099902138113976, -0.0015871907817199826, 0.03125545009970665, -0.0008432740578427911,
0.02850712649524212, -0.003597071161493659, -0.010023299604654312, -0.01402453612536192, -0.010191701352596283,
0.03877292573451996, 0.016947997733950615, 0.007975528948009014, 0.02648629993200302, -0.0128996092826128,
-0.0030245035886764526, -0.001790115493349731, -0.01582980714738369, -0.002431727945804596, 0.005510120186954737,
-0.005328245926648378, -0.0053248777985572815, -0.030716562643647194, -0.019372990354895592, -0.02592046745121479,
-0.0010003091301769018, 0.004725365899503231, -0.04375762864947319, 0.01600494608283043, -0.016611194238066673,
-0.0023188984487205744, 0.013808981515467167, 0.030096841976046562, 0.027887405827641487, -0.017904523760080338,
0.029719622805714607, 0.0402548648416996, -0.01382245309650898, -0.0029571428894996643, -0.08401249349117279,
0.014496061950922012, -0.003516238182783127, 0.006227513775229454, 0.03462349250912666, -0.00679334532469511,
-0.006022063083946705, 0.023616725578904152, -0.014469117857515812, -0.016665082424879074, -0.03861125931143761,
-0.013889813795685768, 0.024802276864647865, 0.00748379435390234, 0.011781418696045876, -0.01847035437822342,
0.01335766352713108, 0.009598925709724426, 0.0013278514379635453, -0.004513179417699575, -0.018793687224388123,
-0.02178451046347618, 9.32000984903425e-05, 0.00799573678523302, -0.00701226806268096, 0.006123104132711887,
0.015008005313575268, 0.001095456420443952, 0.012057597748935223, -0.002600130159407854, -0.0027180116157978773,
-0.0013312194496393204, -0.013236413709819317, 0.03284516558051109, 0.0019332573283463717, -0.004533387254923582,
0.012812039814889431, 0.008218027651309967, -0.003187853842973709, -0.010447673499584198, -0.003418564796447754,
0.03896153345704079, -0.0011139806592836976, -0.015156199224293232, 0.0201813206076622, 0.003853042609989643,
0.009201496839523315, 0.017392579466104507, -0.004078701604157686, 0.00679671298712492, -0.011424405500292778,
-0.022377286106348038, 0.005035226233303547, 0.013512593694031239, 0.002918410347774625, -0.011626488529145718,
0.0013379555894061923, -0.028183793649077415, -0.011646696366369724, -0.0010331475641578436, 0.023037422448396683,
-0.005156475584954023, -0.016126194968819618, 0.0038463063538074493, 0.0072817113250494, 0.005200260318815708,
0.022956589236855507, -0.006611470598727465, -0.006746192462742329, 0.028749624267220497, -0.020140904933214188,
0.03187517076730728, 0.03815320506691933, 0.017055775970220566, -0.019534656777977943, 0.005004913546144962,
0.011855515651404858, -0.03737181797623634, 0.015263976529240608, 0.006042271386831999, -0.01736563630402088,
-0.022902701050043106, -0.006688935682177544, 0.0015829807380214334, -0.0007775971898809075, -0.01252912450581789,
0.014132313430309296, 0.011909403838217258, 0.006267930381000042, -0.002014090307056904, -0.003694744547829032,
-0.010730588808655739, -0.02963878959417343, 0.01100676879286766, 0.0335996076464653, -0.012710998766124249,
-0.005823348183184862, -0.006200569216161966, -0.02947712317109108, -0.00856830459088087, -0.00957871787250042,
-0.029611844569444656, -0.02271408960223198, -0.0031642774119973183, -0.002039350802078843, 0.003617279464378953,
-0.012737942859530449, -0.02671532705426216, -0.009962675161659718, 0.03249489143490791, -0.006237617693841457,
-0.009814480319619179, 0.018887991085648537, 0.014172730036079884, -0.0039372434839606285, 0.033114612102508545,
-0.022916173562407494, -0.014549951069056988, -0.021178262308239937, -0.02150159329175949, -0.03233322501182556,
0.011020240373909473, -0.015385225415229797, 0.03958125412464142, -0.001887788763269782, -0.009161080233752728,
-0.012320305220782757, -0.00749726640060544, -0.03494682535529137, -0.032602667808532715, -0.012488707900047302,
0.009248649701476097, -0.015277448110282421, -0.012865928933024406, 0.0031457531731575727, -0.002684331266209483,
-0.0051699476316571236, 0.014347868040204048, -0.010131076909601688, 0.010966352187097073, -0.011451350525021553,
-0.03354572132229805, -0.00029196732793934643, 0.003890091087669134, -0.04300318658351898, -0.002394679468125105,
-0.002657386939972639, -0.029504066333174706, -0.00043110965634696186, 0.024330751970410347, 0.008204556070268154,
-0.0025378211867064238, 0.010198437608778477, -0.01324314996600151, 0.006190465297549963, 0.01646300032734871,
0.00527435727417469, -0.009538301266729832, 0.0012234420282766223, -0.0009346322622150183, 0.00560779357329011,
-0.014199674129486084, -0.008857956156134605, -0.0012276520719751716, 0.00399786839261651, 0.013465440832078457,
-0.02821073867380619, -0.015237031504511833, 0.0043009924702346325, 0.0008950577466748655, -0.024802276864647865,
1.230783345818054e-05, -0.014442173764109612, 0.04001236334443092, -0.0021218678448349237, -0.010750796645879745,
-0.030231565237045288, -0.014954116195440292, -0.0024233078584074974, 0.025327691808342934, -0.012495444156229496,
-0.018443409353494644, 0.010501561686396599, 0.003443825291469693, 0.005789667833596468, -0.0051328991539776325,
-0.009767328388988972, -0.0057088350877165794, 0.01230009738355875, -0.0333840548992157, 0.030554896220564842,
-0.001921469229273498, -0.010131076909601688, -0.00620730547234416, -0.007766709662973881, -0.025071721524000168,
-0.011774682439863682, 0.0031491213012486696, 0.029692677780985832, -0.013532801531255245, 0.008332541212439537,
0.012313569895923138, 0.0040517570450901985, -0.002445199992507696, 0.010636283084750175, 0.004233631771057844,
-0.015668140724301338, -0.009140871465206146, 0.2959567904472351, 0.011148226447403431, -0.009390107356011868,
0.03284516558051109, -0.0064060199074447155, 0.013808981515467167, 0.022512007504701614, 0.0038294661790132523,
-0.008063097484409809, -0.00024186767404899, -0.007982264272868633, 0.005237308796495199, -0.039769865572452545,
-0.016085779294371605, -0.012124959379434586, -0.03287211060523987, -0.03155183792114258, -0.026971297338604927,
-0.007005531806498766, 0.0016882321797311306, 0.006133208516985178, -0.007874486967921257, 0.005385502707213163,
-0.03475821763277054, 0.019521184265613556, -0.003650959813967347, 0.01502147689461708, -0.01358669064939022,
0.02201353758573532, 0.013000650331377983, -0.028587959706783295, -0.005796404089778662, 0.011895932257175446,
0.0168536938726902, 0.002357630990445614, 0.014576895162463188, 0.005398974753916264, 0.029692677780985832,
0.030527953058481216, 0.0012049177894368768, -0.0006963431369513273, -0.01238766685128212, 0.018497299402952194,
-0.02041034772992134, 0.00386314676143229, 0.02821073867380619, -0.03858431428670883, -0.02053159661591053,
-0.028749624267220497, -0.004711893852800131, -0.002438463969156146, 0.010824893601238728, 0.005793035961687565,
0.037991538643836975, -0.030069898813962936, -0.0028190528973937035, 0.00029807191458530724, 0.004122485872358084,
0.018847575411200523, -0.009598925709724426, 0.007921639829874039, 0.01931910216808319, -0.030231565237045288,
0.013094956055283546, -0.007530946750193834, 0.011579335667192936, -0.02162284404039383, 0.008824275806546211,
0.021407289430499077, -0.01829521544277668, 0.0038564105052500963, -0.014132313430309296, -0.009369898587465286,
-0.007160461973398924, -0.015344809740781784, -0.03594376891851425, 0.013600162230432034, -0.00689775450155139,
0.020787568762898445, 0.03624015673995018, 0.0011064024874940515, -0.004381825681775808, -0.006840497720986605,
-0.008123722858726978, -0.002928514499217272, -0.01882063038647175, 0.03244100138545036, -0.006059111561626196,
-0.004634428769350052, -0.007470321841537952, 0.010353367775678635, -0.0067899771966040134, -0.009868369437754154,
-0.012468499131500721, 0.00903309416025877, -0.002377839293330908, 0.017635079100728035, 0.040281809866428375,
-0.012131694704294205, 0.003583599114790559, -0.025947412475943565, 0.050089552998542786, 0.0075242104940116405,
0.010427464731037617, -0.010144549421966076, 0.015856752172112465, -0.012401138432323933, 0.003214798169210553,
0.008810803294181824, -0.034380994737148285, -0.009295801632106304, -0.03985070064663887, 0.011895932257175446,
-0.005048698280006647, 0.015371753834187984, -0.002290270058438182, 0.015169670805335045, -0.04351513087749481,
0.01029947865754366, -0.0009657866903580725, 0.039608199149370193, -0.025368109345436096, -0.0354587696492672,
0.03494682535529137, -0.010993296280503273, -0.012630165554583073, -0.01750035770237446, 0.02621685527265072,
0.009996355511248112, -0.014576895162463188, 0.0026085502468049526, -0.02511213719844818, 0.002904938068240881,
0.004796094726771116, 0.006247722078114748, -0.0029504066333174706, 0.005877237301319838, 0.005270989146083593,
0.0009590506087988615, 0.013505857437849045, 0.011599544435739517, 0.004402033518999815, 0.021609371528029442,
0.012569541111588478, -0.0014196306001394987, -0.008015945553779602, 0.015156199224293232, 0.0011173486709594727,
0.010555450804531574, -0.03244100138545036, -0.02655366063117981, -0.01600494608283043, 0.012852456420660019,
-0.008204556070268154, 0.022512007504701614, 0.021878814324736595, -0.03540487959980965, -0.0041864789091050625,
-2.715485607041046e-05, 0.004405401647090912, -0.03877292573451996, -0.0032568988390266895, 0.02041034772992134,
0.0006765558500774205, -0.009848161600530148, -0.013431760482490063, -0.17125831544399261, 0.00900615006685257,
0.016355222091078758, -0.040470417588949203, 0.02489658258855343, 0.026189912110567093, 0.0063689714297652245,
-0.00399786839261651, -0.009268857538700104, -0.010461145080626011, 0.050601497292518616, -0.025556718930602074,
-0.011680377647280693, -0.01973673887550831, 0.003630751743912697, 0.006005222909152508, -0.05057455226778984,
0.027335045859217644, -0.003144069341942668, -0.005139635410159826, 0.01910354569554329, -0.03923097997903824,
-0.007180670276284218, 0.0010449356632307172, 0.012636901810765266, 0.0013152213068678975, -0.0004420558107085526,
0.00550338439643383, -0.013303774408996105, -0.03343794122338295, 0.017459940165281296, -0.0382879264652729,
0.023077838122844696, 0.008743442595005035, 0.023037422448396683, -0.014091896824538708, -0.016880637034773827,
0.0005801456281915307, -0.019817572087049484, 0.025448942556977272, -0.023603253066539764, 0.02998906560242176,
0.003613911336287856, 0.00274664000608027, 0.022296452894806862, 0.018322160467505455, -0.023657143115997314,
-0.008925316855311394, 0.011134753935039043, -0.0027297998312860727, 0.02621685527265072, -0.03782987222075462,
0.024505889043211937, -0.006099528167396784, 0.0257992185652256, 0.013782036490738392, -0.009484412148594856,
0.02982739917933941, -0.004058493301272392, 0.007113309111446142, -0.007261503487825394, -0.0016267653554677963,
0.0168536938726902, 0.013606898486614227, 0.017877578735351562, -0.01667855493724346, -0.012151903472840786,
0.004981337580829859, -0.00856830459088087, 0.00493081659078598, -0.00940357893705368, -0.005486543755978346,
0.03039323166012764, -0.010723852552473545, 0.014846338890492916, 0.026809630915522575, 0.0055168564431369305,
-0.005809876136481762, -0.01545258704572916, 0.0006125630461610854, -0.018389521166682243, 0.018443409353494644,
-0.0290729571133852, -0.0014861495001241565, 0.002526033204048872, 0.0018591603729873896, -0.0017480149399489164,
0.0015922428574413061, 0.003775577526539564, 0.0034471931867301464, 0.02151506580412388, -0.02333381026983261,
-0.00923517718911171, -0.001971989870071411, -0.010946143418550491, 0.007759973872452974, 0.004422241821885109,
0.0012276520719751716, 0.009329481981694698, -0.012340513989329338, -0.004193215165287256, 0.005486543755978346,
-0.014374812133610249, -0.0006875020335428417, 0.0019837780855596066, 0.018618548288941383, 0.019305629655718803,
0.010690172202885151, 0.057714805006980896, -0.007840806618332863, -0.027456296607851982, -0.01759466342628002,
0.020154375582933426, 0.035809047520160675, 0.0040147085674107075, 0.04227568954229355, -0.024519361555576324,
-0.009571981616318226, 0.001817059819586575, -0.013674259185791016, -0.003691376419737935, -0.02000618167221546,
0.0013303774176165462, 0.03368044272065163, 0.0023357386235147715, -0.018672436475753784, -0.0718875378370285,
-0.020558541640639305, 0.01995229348540306, -0.0014650991652160883, -0.0201813206076622, 0.019453823566436768,
0.0004521599330473691, 0.010467881336808205, -0.0222560353577137, 0.022053953260183334, 0.013654051348567009,
-0.05658314377069473, -0.005941229872405529, -0.029234623536467552, 0.013984119519591331, -0.022525480017066002,
0.00712678162381053, -0.003778945654630661, -0.018955351784825325, 0.025880051776766777, -0.004011340439319611,
-0.03675209730863571, 0.008898372761905193, -0.013377871364355087, 0.013660787604749203, 0.022606313228607178,
-0.030986007302999496, 0.011747738346457481, 0.015789391472935677, -0.0017261226894333959, -0.001992198172956705,
-0.022916173562407494, 0.003073340281844139, -0.013984119519591331, 0.0012857508845627308, -0.014374812133610249,
-0.0021976488642394543, -0.0290190689265728, 0.024815749377012253, -0.016530361026525497, 0.002704539569094777,
-0.0019248372409492731, 0.011808362789452076, -0.013512593694031239, -0.025785746052861214, -0.01616661250591278,
-0.008743442595005035, 0.015951057896018028, 0.013115163892507553, -0.0064834849908947945, -0.020733680576086044,
-0.00943726021796465, -0.025368109345436096, -0.006342027336359024, 0.008716498501598835, -0.01950771175324917,
0.024236446246504784, 0.010151284746825695, -0.025166025385260582, -0.00957871787250042, 0.005008281674236059,
0.0007102363160811365, -0.020558541640639305, 0.004385193344205618, -0.005638105794787407, -0.010259062983095646,
0.0004134274204261601, -0.024910055100917816, 0.012246208265423775, -0.00374863320030272, -0.0057256752625107765,
-0.0006260352092795074, 0.0031693296041339636, -0.010211910121142864, -0.025031303986907005, -5.052066262578592e-05,
-0.019534656777977943, -0.006069215480238199, -0.007887959480285645, -0.030150732025504112, -0.015088837593793869,
-0.00039511368959210813, 0.003194589866325259, -0.042356524616479874, 0.009221704676747322, 0.020033126696944237,
0.007887959480285645, -0.010636283084750175, 0.015075366012752056, -0.0338151641190052, 0.006129840388894081,
0.024748388677835464, 0.005119427107274532, 0.00375536922365427, -0.024869637563824654, -0.001521513913758099,
-0.003560022683814168, 0.023953530937433243, -0.003758737351745367, 0.026082133874297142, 0.005270989146083593,
-0.03262961283326149, -0.06951643526554108, 0.0075646270997822285, -0.013775301165878773, 0.015075366012752056,
0.007301919627934694, 0.005779563914984465, 0.0402548648416996, -0.022094368934631348, 0.006594630423933268,
0.017742857336997986, -0.007840806618332863, -0.017352163791656494, 0.010050243698060513, 0.0004172164772171527,
-0.02248506247997284, -0.008817539550364017, 0.0006980271427892148, -0.0017682232428342104, 0.010353367775678635,
0.01782369054853916, -0.004836511332541704, -0.019359517842531204, -0.009625870734453201, 0.003954083658754826,
-0.03090517409145832, 0.009794272482395172, -0.02058548666536808, 0.04478151723742485, -0.010023299604654312,
-0.017244385555386543, 0.013169053010642529, -0.015061893500387669, -0.007227822672575712, 0.0022161731030792,
-0.0311476718634367, 0.005813244264572859, 0.007274975534528494, 0.00550338439643383, 0.0017042303225025535,
0.028291571885347366, -0.000128511936054565, -0.013526065275073051, 0.01496758870780468, -0.01669202744960785,
-0.018793687224388123, 0.0029571428894996643, -0.011417670175433159, -0.009248649701476097, 0.022956589236855507,
-0.011714057996869087, -0.0016848640516400337, 0.015075366012752056, 0.006375707685947418, -0.0401470884680748,
-0.013674259185791016, -0.036617375910282135, -0.00013187997683417052, -0.028372405096888542, -0.011303156614303589,
-0.016665082424879074, 0.020154375582933426, 0.02804907225072384, 0.007463586051017046, -0.006725984159857035,
0.011074129492044449, 0.004927448462694883, -0.032548777759075165, 0.005530328489840031, 0.021420761942863464,
-0.01891493611037731, -0.025435470044612885, 0.008285388350486755, 0.017621606588363647, 0.004957761149853468,
-0.008238236419856548, 0.002526033204048872, -0.0023694189731031656, 0.022606313228607178, -0.013148844242095947,
0.0145095344632864, 0.0012554384302347898, 0.0005519382539205253, -0.012394402176141739, -0.011707321740686893,
0.017702439799904823, 0.021299511194229126, -0.019413406029343605, -0.00831906870007515, -0.013182524591684341,
-0.010905726812779903, -0.008130459114909172, 0.020383402705192566, -0.003671168116852641, -0.0044357143342494965,
-0.017931466922163963, 0.015789391472935677, -0.026540188118815422, 0.006560950074344873, 0.002280165906995535,
0.03314155340194702, -0.008763651363551617, 0.01101350411772728, 0.016328278928995132, -0.01178815495222807,
-0.021137844771146774, 0.03648265451192856, -0.018335632979869843, 0.002039350802078843, -0.013748356141149998,
0.01287940051406622, 0.015802863985300064, 0.009881841950118542, -0.00701226806268096, 0.014267034828662872,
0.0004715261748060584, 0.01956159994006157, -0.018605075776576996, -0.00422689551487565, -0.02202700823545456,
0.032090723514556885, 0.019453823566436768, 0.011626488529145718, 0.0024233078584074974, 0.012535860762000084,
0.008905109018087387, 0.001111454563215375, 0.019857987761497498, -0.013007386587560177, -0.009046566672623158,
0.012138430960476398, 0.022673673927783966, -0.004843247588723898, 0.000916950055398047, -0.020087014883756638,
-0.021595899015665054, -0.001648657605983317, -0.021528538316488266, 0.005139635410159826, -0.016139667481184006,
0.04841900244355202, 0.03494682535529137, 0.0055741132237017155, 0.014684672467410564, 0.004250471945852041,
-0.003482557600364089, -0.004344777204096317, -0.014038007706403732, -0.03446182981133461, -0.006645150948315859,
0.030150732025504112, -0.015304393135011196, 0.020275626331567764, -0.009228440932929516, 0.005934494081884623,
0.007800390478223562, -0.017177024856209755, -0.015169670805335045, -0.0009413683437742293, -0.004927448462694883,
0.02856101468205452, -0.016301333904266357, 0.012239472940564156, 0.013903286308050156, -0.03801848366856575,
0.008837748318910599, 0.030231565237045288, -0.002925146371126175, -0.00799573678523302, -0.031740449368953705,
0.014859811402857304, 0.007955320179462433, -0.058577023446559906, -0.014496061950922012, -0.0156546700745821,
0.0005195208359509706, 0.0022178571671247482, -0.028022127225995064, 0.03597071021795273, 0.00514637166634202,
-0.00040858585271053016, 0.038395702838897705, -0.016934527084231377, -0.006180360913276672, 0.03893459215760231,
-0.018429938703775406, 0.0012234420282766223, -0.01252912450581789, 0.0057660918682813644]

list = FileChunk().search_points(4664, a)
print(len(list))
for p in list:
    print(p)
# FileChunk().search_points(4910)
